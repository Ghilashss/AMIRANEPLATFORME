{
  "info": {
    "name": "Plateforme Livraison API",
    "description": "Collection compl√®te pour tester l'API de la plateforme de livraison",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5000/api"
    },
    {
      "key": "token",
      "value": ""
    }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nom\": \"Test\",\n  \"prenom\": \"User\",\n  \"email\": \"test@test.com\",\n  \"telephone\": \"0555123456\",\n  \"password\": \"123456\",\n  \"role\": \"commercant\",\n  \"wilaya\": \"16\",\n  \"adresse\": \"123 Rue Test, Alger\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/auth/register",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "register"]
            }
          }
        },
        {
          "name": "Login Admin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.data && jsonData.data.token) {",
                  "    pm.collectionVariables.set('token', jsonData.data.token);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@platforme.com\",\n  \"password\": \"admin123\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Login Commercant",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.data && jsonData.data.token) {",
                  "    pm.collectionVariables.set('token', jsonData.data.token);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"commercant@test.com\",\n  \"password\": \"123456\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Get Me",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/me",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "me"]
            }
          }
        },
        {
          "name": "Update Profile",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nom\": \"Nouveau Nom\",\n  \"telephone\": \"0666999888\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/auth/updateprofile",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "updateprofile"]
            }
          }
        }
      ]
    },
    {
      "name": "Wilayas",
      "item": [
        {
          "name": "Get All Wilayas (Public)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/wilayas",
              "host": ["{{baseUrl}}"],
              "path": ["wilayas"]
            }
          }
        },
        {
          "name": "Get Wilaya by Code (Public)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/wilayas/16",
              "host": ["{{baseUrl}}"],
              "path": ["wilayas", "16"]
            }
          }
        },
        {
          "name": "Create Wilaya (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"99\",\n  \"nom\": \"Test Wilaya\",\n  \"fraisLivraison\": {\n    \"domicile\": 500,\n    \"stopDesk\": 350\n  },\n  \"delaiLivraison\": \"2-3 jours\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/wilayas",
              "host": ["{{baseUrl}}"],
              "path": ["wilayas"]
            }
          }
        },
        {
          "name": "Update Frais (Admin)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"domicile\": 600,\n  \"stopDesk\": 400\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/wilayas/16/frais",
              "host": ["{{baseUrl}}"],
              "path": ["wilayas", "16", "frais"]
            }
          }
        }
      ]
    },
    {
      "name": "Agences",
      "item": [
        {
          "name": "Get All Agences",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/agences",
              "host": ["{{baseUrl}}"],
              "path": ["agences"]
            }
          }
        },
        {
          "name": "Get Agences by Wilaya (Public)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/agences/wilaya/16",
              "host": ["{{baseUrl}}"],
              "path": ["agences", "wilaya", "16"]
            }
          }
        },
        {
          "name": "Create Agence (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nom\": \"Agence Test\",\n  \"wilaya\": \"16\",\n  \"wilayaText\": \"Alger\",\n  \"email\": \"test@agence.com\",\n  \"telephone\": \"021123456\",\n  \"adresse\": \"123 Rue Test, Alger\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/agences",
              "host": ["{{baseUrl}}"],
              "path": ["agences"]
            }
          }
        },
        {
          "name": "Update Agence (Admin)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"telephone\": \"021999888\",\n  \"status\": \"active\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/agences/:id",
              "host": ["{{baseUrl}}"],
              "path": ["agences", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "name": "Get Agence Stats",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/agences/:id/stats",
              "host": ["{{baseUrl}}"],
              "path": ["agences", ":id", "stats"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Colis",
      "item": [
        {
          "name": "Create Colis",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"destinataire\": {\n    \"nom\": \"Martin Paul\",\n    \"telephone\": \"0777123456\",\n    \"adresse\": \"456 Avenue Test\",\n    \"wilaya\": \"16\",\n    \"commune\": \"Alger Centre\"\n  },\n  \"typeLivraison\": \"domicile\",\n  \"typeArticle\": \"vetements\",\n  \"montant\": 5000,\n  \"poids\": 1.5,\n  \"notes\": \"Fragile - Appeler avant livraison\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/colis",
              "host": ["{{baseUrl}}"],
              "path": ["colis"]
            }
          }
        },
        {
          "name": "Get All Colis",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/colis?page=1&limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["colis"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "status",
                  "value": "en_attente",
                  "disabled": true
                },
                {
                  "key": "wilaya",
                  "value": "16",
                  "disabled": true
                }
              ]
            }
          }
        },
        {
          "name": "Get Colis by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/colis/:id",
              "host": ["{{baseUrl}}"],
              "path": ["colis", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "name": "Track Colis (Public)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/colis/tracking/:tracking",
              "host": ["{{baseUrl}}"],
              "path": ["colis", "tracking", ":tracking"],
              "variable": [
                {
                  "key": "tracking",
                  "value": "COL2501150001"
                }
              ]
            }
          }
        },
        {
          "name": "Update Status",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"en_livraison\",\n  \"description\": \"Colis en cours de livraison\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/colis/:id/status",
              "host": ["{{baseUrl}}"],
              "path": ["colis", ":id", "status"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "name": "Assign to Agence (Admin)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"agenceId\": \"ID_AGENCE\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/colis/:id/assign-agence",
              "host": ["{{baseUrl}}"],
              "path": ["colis", ":id", "assign-agence"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "name": "Assign to Livreur",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"livreurId\": \"ID_LIVREUR\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/colis/:id/assign-livreur",
              "host": ["{{baseUrl}}"],
              "path": ["colis", ":id", "assign-livreur"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        },
        {
          "name": "Get Colis Stats",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/colis/stats",
              "host": ["{{baseUrl}}"],
              "path": ["colis", "stats"]
            }
          }
        },
        {
          "name": "Delete Colis",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/colis/:id",
              "host": ["{{baseUrl}}"],
              "path": ["colis", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": ""
                }
              ]
            }
          }
        }
      ]
    }
  ]
}
